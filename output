./opa eval --input input.json --data dns_bofa.rego "data.terraform.azure.dns.deny_list"
Evaluating resource: {"change": {"after": {"name": "test.vaultcore.azure.net", "resource_group_name": "rg-eus-71148-test"}}, "type": "azurerm_private_dns_zone"}
Validating DNS Zone Name: test.vaultcore.azure.net
Validating Resource Group Name: rg-eus-71148-test
Checking DNS Zone Name Regex Match: test.vaultcore.azure.net
Evaluating resource: {"change": {"after": {"name": "privatelink.vaultcore.azure.net", "resource_group_name": "rg-prod-dns"}}, "type": "azurerm_private_dns_zone"}
Validating DNS Zone Name: privatelink.vaultcore.azure.net
Validating Resource Group Name: rg-prod-dns
Checking DNS Zone Name Regex Match: privatelink.vaultcore.azure.net
{
  "result": [
    {
      "expressions": [
        {
          "value": [
            {
              "error": "Invalid DNS zone configuration",
              "name": "test.vaultcore.azure.net",
              "resource_group": "rg-eus-71148-test"
            },
            {
              "error": "Invalid DNS zone configuration",
              "name": "privatelink.vaultcore.azure.net",
              "resource_group": "rg-prod-dns"
            }
          ],
          "text": "data.terraform.azure.dns.deny_list",
          "location": {
            "row": 1,
            "col": 1
          }
        }
      ]
    }
  ]
}
