{
  "sns_existing_topic_policy_overwrite_warn": {
    "invalid_existing_topic_used": {
      "resource_changes": [
        {
          "address": "aws_s3_bucket_notification.example",
          "type": "aws_s3_bucket_notification",
          "change": {
            "actions": ["create"],
            "after": {
              "topic": [
                { "topic_arn": "arn:aws:sns:us-east-1:123456789012:existing-topic" }
              ]
            }
          }
        }
      ]
    },
    "valid_topic_created_in_plan": {
      "resource_changes": [
        {
          "address": "aws_sns_topic.created",
          "type": "aws_sns_topic",
          "change": {
            "actions": ["create"],
            "after": { "arn": "arn:aws:sns:us-east-1:123456789012:created-topic" }
          }
        },
        {
          "address": "aws_s3_bucket_notification.example",
          "type": "aws_s3_bucket_notification",
          "change": {
            "actions": ["create"],
            "after": {
              "topic": [
                { "topic_arn": "arn:aws:sns:us-east-1:123456789012:created-topic" }
              ]
            }
          }
        }
      ]
    },
    "invalid_duplicate_use_same_topic": {
      "resource_changes": [
        {
          "address": "aws_s3_bucket_notification.one",
          "type": "aws_s3_bucket_notification",
          "change": {
            "actions": ["create"],
            "after": {
              "topic": [
                { "topic_arn": "arn:aws:sns:us-east-1:123456789012:existing-topic" }
              ]
            }
          }
        },
        {
          "address": "aws_s3_bucket_notification.two",
          "type": "aws_s3_bucket_notification",
          "change": {
            "actions": ["update"],
            "after": {
              "topic": [
                { "topic_arn": "arn:aws:sns:us-east-1:123456789012:existing-topic" }
              ]
            }
          }
        }
      ]
    }
  },
  "sns_topic_unique_name_check": {
    "invalid_duplicate_names": {
      "resource_changes": [
        {
          "address": "aws_sns_topic.topic1",
          "type": "aws_sns_topic",
          "change": {
            "actions": ["create"],
            "after": {
              "name": "my-duplicate-topic"
            }
          }
        },
        {
          "address": "aws_sns_topic.topic2",
          "type": "aws_sns_topic",
          "change": {
            "actions": ["create"],
            "after": {
              "name": "my-duplicate-topic"
            }
          }
        }
      ]
    },
    "valid_unique_names": {
      "resource_changes": [
        {
          "address": "aws_sns_topic.topic1",
          "type": "aws_sns_topic",
          "change": {
            "actions": ["create"],
            "after": {
              "name": "unique-topic-1"
            }
          }
        },
        {
          "address": "aws_sns_topic.topic2",
          "type": "aws_sns_topic",
          "change": {
            "actions": ["create"],
            "after": {
              "name": "unique-topic-2"
            }
          }
        }
      ]
    },
    "invalid_three_duplicates": {
      "resource_changes": [
        {
          "address": "aws_sns_topic.topic1",
          "type": "aws_sns_topic",
          "change": {
            "actions": ["create"],
            "after": {
              "name": "same-name"
            }
          }
        },
        {
          "address": "aws_sns_topic.topic2",
          "type": "aws_sns_topic",
          "change": {
            "actions": ["create"],
            "after": {
              "name": "same-name"
            }
          }
        },
        {
          "address": "aws_sns_topic.topic3",
          "type": "aws_sns_topic",
          "change": {
            "actions": ["create"],
            "after": {
              "name": "same-name"
            }
          }
        }
      ]
    },
    "invalid_multiple_duplicate_sets": {
      "resource_changes": [
        {
          "address": "aws_sns_topic.prod1",
          "type": "aws_sns_topic",
          "change": {
            "actions": ["create"],
            "after": {
              "name": "prod-topic"
            }
          }
        },
        {
          "address": "aws_sns_topic.prod2",
          "type": "aws_sns_topic",
          "change": {
            "actions": ["create"],
            "after": {
              "name": "prod-topic"
            }
          }
        },
        {
          "address": "aws_sns_topic.dev1",
          "type": "aws_sns_topic",
          "change": {
            "actions": ["create"],
            "after": {
              "name": "dev-topic"
            }
          }
        },
        {
          "address": "aws_sns_topic.dev2",
          "type": "aws_sns_topic",
          "change": {
            "actions": ["create"],
            "after": {
              "name": "dev-topic"
            }
          }
        }
      ]
    }
  }
}
